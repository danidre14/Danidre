<% let distanceToNow; %>
<% var user; %>
<% let fullName = (profile.firstName || "") + " " + (profile.lastName || ""); %>
<h2><%= profile.username %>'s Profile</h2>
<section class="profile">
    <article>
        <div class="profile-main">
            <div>
                <img class="profile-img-big" src="<%= profile.profileImagePath %>" onerror="if (this.src != '../../../images/UsersIcon.png') this.src = '../../../images/UsersIcon.png';">
            </div>
            <div class="profile-main-det">
                <div>
                    <span class="profile-name"><%= profile.username %></span>
                </div>
                <div>
                    <span><%= fullName.trim() === ""? '' : 'Name: ' + fullName %></span>
                </div>
                <div style="position:absolute;bottom:0;">
                    <div style="line-height:.8rem;">Roles: <i><%= profile.roles.join(', ') %></i></div>
                    <% distanceToNow = formatDistanceToNow(profile.lastSeen); %>
                    <% if(distanceToNow === 'Online') { %>
                        <div style="color:#4cdb4c;font-weight:500;font-size:.7rem;"><%= distanceToNow %> </div>
                    <% } else if(distanceToNow === 'never') { %>
                        <% distanceToNow = formatDistanceToNow(profile.updatedAt); %>
                        <div style="color:#c43d3d;font-weight:500;font-size:.7rem;">Last seen <%= distanceToNow %> </div>
                    <% } else { %>
                        <div style="color:#e29c33;font-weight:500;font-size:.7rem;">Last seen <%= distanceToNow %> </div>
                    <% } %>
                </div>
            </div>
        </div>
        <br/>
        <% if(profile.bio.trim() !== "") { %>
            <div class="profile-bio-box">
                <div style="background-color:var(--color-footer);width:1rem;height:1rem;position:absolute;top:-.4rem;left:.5rem;transform:rotate(45deg);"></div>
                <pre><%= profile.bio %></pre>
            </div>
            <br/>
        <% } %>
        <%=//<desc>Created At:</desc><p> profile.createdAt.toLocaleString() </p>%>
        <%=//<desc>Updated At:</desc><p> profile.updatedAt.toLocaleString()</p>%>

        <% if(user !== undefined && user.username == profile.username) { %>
            <div class="div-space-between">
                <a class="btn btn-primary" href="/u/">Other Users</a>
                <a class="btn btn-primary" href="/u/<%= user.username %>/edit">Edit Profile</a>
            </div>
        <% } else if(user !== undefined) { %>
            <div class="div-space-between">
                <a class="btn btn-primary" href="/u/">Other Users</a>
                <a class="btn btn-primary" href="/u/<%= user.username %>/#navManu">Your Profile</a>
            </div>
        <% } %>
    </article>
</section>
<meta name="description" content="<%=profile.username%>'s Profile Page.">
